<!doctype HTML>

<html>

<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"></script>    
<script type="text/javascript">
function toTitleCase(str)
{
    return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
}
_.chunk = function(array, n) {
    var chunks = [];
    var numChunks = Math.ceil(array.length / n);
    for(var i = 0; i < numChunks; i++) {
      chunks.push(array.slice(i * n, i * n + n));
    }
    return chunks;
}

</script>
<script type="text/template" id="template"><?xml version="1.0" encoding="UTF-8"?>
<svg>
  <variableSets>
    <variableSet locked="none">
      <variables>
        <variable varName="Variable0" trait="textcontent"/>
        <variable varName="Variable1" trait="textcontent"/>
        <variable varName="Variable2" trait="textcontent"/>
        <variable varName="Variable3" trait="textcontent"/>
        <variable varName="Variable4" trait="textcontent"/>
        <variable varName="Variable5" trait="textcontent"/>
        <variable varName="Variable6" trait="textcontent"/>
        <variable varName="Variable7" trait="textcontent"/>
      </variables>
      <v:sampleDataSets xmlns:v="casamiento">
      <% var counter = 0; %>
      <% var name_counter = "" %>
      <% names.forEach(function(list) { %>
      <% name_counter = 0 %>
        <v:sampleDataSet dataSetName="<%=counter %>">
        <% for(var i =0; i < 8; i++) { %>
            <% var name = list[i] %>
        <% name == undefined ? name = "" : name = name %>
          <Variable<%= name_counter %>>
            <p><%= name %></p>
          </Variable<%= name_counter %>>
          <% name_counter = name_counter + 1 %>
          <% } %>
        </v:sampleDataSet>
        <% counter = counter + 1; %>
        <% }) %>
      </v:sampleDataSets>underscore 
    </variableSet>
  </variableSets>
</svg></script>
<script type="text/template" id="table_template"><?xml version="1.0" encoding="UTF-8"?>
<svg>
  <variableSets>
    <variableSet locked="none">
      <variables>
        <variable varName="Variable0" trait="textcontent"/>
        <variable varName="Variable1" trait="textcontent"/>
        <variable varName="Variable2" trait="textcontent"/>
        <variable varName="Variable3" trait="textcontent"/>
        <variable varName="Variable4" trait="textcontent"/>
        <variable varName="Variable5" trait="textcontent"/>
        <variable varName="Variable6" trait="textcontent"/>
        <variable varName="Variable7" trait="textcontent"/>
        <variable varName="Variable8" trait="textcontent"/>
        <variable varName="Variable9" trait="textcontent"/>
        <variable varName="Variable10" trait="textcontent"/>
        <variable varName="Variable11" trait="textcontent"/>
        <variable varName="Variable12" trait="textcontent"/>
        <variable varName="Variable13" trait="textcontent"/>
        <variable varName="Variable14" trait="textcontent"/>
        <variable varName="Variable15" trait="textcontent"/>
      </variables>
      <v:sampleDataSets xmlns:v="casamiento">
      <% var counter = 0; %>
      <% var name_counter = "" %>
      <% names.forEach(function(list) { %>
      <% name_counter = 0 %>
        <v:sampleDataSet dataSetName="<%=counter %>">
        <% for(var i =0; i < 16; i++) { %>
            <% var name = list[i] %>
        <% name == undefined ? name = "" : name = name %>
          <Variable<%= name_counter %>>
            <p><%= name %></p>
          </Variable<%= name_counter %>>
          <% name_counter = name_counter + 1 %>
          <% } %>
        </v:sampleDataSet>
        <% counter = counter + 1; %>
        <% }) %>
      </v:sampleDataSets>underscore 
    </variableSet>
  </variableSets>
</svg></script>
<script type="text/javascript">
var doNames = function() {

  var names = $('#names').val()
  names = $.trim(names);

  names = names.split("\n");
  names = names.sort();
  for (i = 0; i < names.length; i++) {
      names[i] = toTitleCase(names[i])
      names[i] = names[i].trim();
  }
  names = _.chunk(names, 8);
  var template = $('#template').html();
  var r = _.template(template, {
      names: names
  });
  $('#download').attr("href", "data:application/octet-stream," + encodeURIComponent(r));
}

var doNamesAndTables = function() {
       var names = $('#names_and_tables').val()
        names = $.trim(names);

        names = names.split("\n");
        for (i = 0; i < names.length; i++) {
            names[i] = toTitleCase(names[i])
            names[i] = names[i].trim();
        }
        names = _.chunk(names, 16);
        var template = $('#table_template').html();
        var r = _.template(template, {
            names: names
        });
        $('#download_tables').attr("href", "data:application/octet-stream," + encodeURIComponent(r));  
        
}

$(function() {
    $('#button').click(
    function() {
        doNames()
        doNamesAndTables()
    });

});
</script>


</head>

<body>
<h1>Original</h1>
<textarea id="names">David
Angel
Tom
Lucas
Mark
Richard
James
John
Helena
Davina
Jason
Matthew
Gemma
Vicky
Lewis
Rosa
Marcus
Gary
Shirley
John
Maria
Daniel
Charlotte
Chloe
Amy
Florence
Jasmin
</textarea>

<textarea id="names_and_tables">David
Angel
Tom
Lucas
Mark
Richard
James
John
Helena
Davina
Jason
Matthew
Gemma
Vicky
Lewis
Rosa
Marcus
Gary
Shirley
John
Maria
Daniel
Charlotte
Chloe
Amy
Florence
Jasmin
</textarea>
<input type="submit" id="button"></input>
<h1>Result</h1>
<a href=""  download="names.xml" id="download">Download</a>

<a href=""  download="names_tables.xml" id="download_tables">Download</a>
</textarea>
</body>
</html>