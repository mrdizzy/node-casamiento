{"ts":1362087041868,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1362087042219,"patch":[[{"diffs":[[1,"Backbone.Model.Attachment = Backbone.Model.extend({\r\n})\r\n\r\nBackbone.Collection.Attachments = Backbone.Collection.extend({\r\n    model: Backbone.Model.Attachment\r\n})\r\n\r\nBackbone.Model.CouchDB = Backbone.Model.extend({\r\n    constructor: function(attributes, options) {\r\n        this._attachments = new Backbone.Collection.Attachments;\r\n        this.attachments_order = [];\r\n        \r\n        Backbone.Model.apply(this, arguments)\r\n    },\r\n    // We overwrite the parse function as when attachments come down the \r\n    // wire we need to parse them out into a separate Backbone collection\r\n    // and make each attachment a Backbone model\r\n    parse: function(resp) {\r\n        var resp = _.clone(resp)\r\n        var parsed_attachments = _.map(resp._attachments, function(value, key, list) {\r\n            return {\r\n                id: key,\r\n                content_type: list[key].content_type,\r\n                length: list[key].length,\r\n            }\r\n        }, this)\r\n        this._attachments.reset(parsed_attachments)\r\n\r\n        this._attachments.url = this.url() + \"/\" + resp._id + \"/attachments\"\r\n        this.attachments_order = resp.attachments_order\r\n        return resp;\r\n    },\r\n    \r\n    addAttachmentGroup: function() {\r\n        var max = this._attachments.max(function(attachment) {\r\n            var split = attachment.id.split(\"-\");\r\n            return split[0];\r\n        })\r\n        var new_id = parseInt(max.id.split(\"-\")[0]) + 1;\r\n\r\n        this.attachment_types.forEach(function(type) {\r\n            this._attachments.add({\r\n                id: new_id + \"-\" + type\r\n            })\r\n        }, this)\r\n        this._attachments.trigger(\"add-group\", new_id)\r\n    },    \r\n    sync: function() {\r\n        var xhr, args = arguments;\r\n\r\n        // Because the FileReader API is asynchronous we have to use a callback\r\n        // style to call Backbone.sync when the files have been read\r\n        this.saveForCouchDB(function(attrs) {\r\n            args[2].attrs = attrs; // args[2] is the options object from arguments\r\n            xhr = Backbone.sync.apply(this, args);\r\n        })\r\n        return xhr;\r\n    },\r\n    // We override the toJSON function as this is what Backbone.sync uses to \r\n    // save our model to the server.\r\n    saveForCouchDB: function(callback) {\r\n        var json = _.clone(this.attributes);\r\n        if (this._attachments.length > 0) {\r\n            json._attachments = {};\r\n            var attachments = this._attachments.filter(function(attachment) {\r\n                return attachment.get(\"binary\");\r\n            });\r\n            // If no files have been added to the model then we return straight away\r\n            if (attachments.length === 0) {\r\n                callback(json)\r\n                return;\r\n            }\r\n            // We need to use a counter as loading of the files is asynchronous\r\n            // and we do not want to return until they are all loaded\r\n            var counter = 0;\r\n            _.each(attachments, function(attachment) {\r\n\r\n                var fReader = new FileReader();\r\n                fReader.onload = function(event) {\r\n\r\n                    counter++;\r\n                    var data = event.target.result.split(\",\")[1];\r\n                    json._attachments[attachment.id] = {\r\n                        content_type: attachment.get(\"content_type\"),\r\n                        data: data\r\n                    }\r\n                    if (counter == attachments.length) {\r\n                        callback(json);\r\n                    }\r\n                }\r\n                fReader.readAsDataURL(attachment.get(\"binary\"))\r\n            })\r\n        }\r\n        else {\r\n            callback(json)\r\n        }\r\n    },\r\n    idAttribute: \"_id\"\r\n});\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// VIEWS\r\n/////////////////////////////////////////////////////////////////////////////////\r\n\r\nBackbone.View.Attachment = Backbone.View.extend({\r\n    constructor: function() {\r\n        var that = this;\r\n        Backbone.View.apply(this, arguments)\r\n        this.el.addEventListener('dragover', function(e) {\r\n            e.preventDefault();\r\n        });\r\n\r\n        // Listen for a file to be dropped on the element and then get the file, set the \r\n        // binary data of the attachment and save it\r\n        this.el.addEventListener('drop', function(e) {\r\n            e.preventDefault();\r\n            var file = e.dataTransfer.files[0];\r\n            that.model.set({\r\n                binary: file,\r\n                content_type: file.type,\r\n                id: e.srcElement.id\r\n            });\r\n        });\r\n        this.listenTo(this.model, \"destroy\", this.remove);\r\n    }\r\n})\r\n\r\nBackbone.View.Attachments = Backbone.View.extend({\r\n    initialize: function() {\r\n        this.model._attachments.on(\"add-group\", this.addAttachmentGroup, this)\r\n    },\r\n    // addAttachment is called with an instance of the new attachment model\r\n    // whenever the addAttachment() method from the parent view class is called. \r\n    addAttachmentGroup: function(id) {\r\n        this.$el.append(this._renderGroup(id))\r\n    },\r\n    render: function() {\r\n        var that = this;\r\n        this.$el.empty();\r\n        this.model.attachments_order.forEach(function(key) {\r\n            this.$el.append(this._renderGroup(key));\r\n        }, this)\r\n                this.$el.sortable({update: function(event,ui) {\r\n                   \r\n            that.model.set(\"attachments_order\", $(this).sortable(\"toArray\"));\r\n                }})\r\n        this.$el.bind(\"update\", function(event, ui) {\r\n            console.log(\"updagte\")\r\n            that.model.set(\"attachments_order\", $(this).sortable(\"toArray\"));\r\n        })\r\n        return this;\r\n    },    \r\n    _renderGroup: function(id) {\r\n        var these_attachments_el = $('<div></div>', {\r\n            id: id\r\n        });\r\n        this.model.attachment_types.forEach(function(type) {\r\n            var attachment_id = id + \"-\" + type;\r\n            var attachment = this.model._attachments.get(attachment_id);\r\n\r\n            var subview = new this.options.view({\r\n                attributes: {\r\n                    id: attachment_id\r\n                },\r\n                model: attachment\r\n            }).render()\r\n            these_attachments_el.append(subview.el);\r\n        }, this)\r\n        return these_attachments_el\r\n    }\r\n})\r\n\r\nBackbone.View.CouchDB = Backbone.View.extend({\r\n    addAttachment: function() {\r\n       this.model.addAttachmentGroup();\r\n    },\r\n    // Extend this view and then call buildAttachments(view) from within the \r\n    // extended view's render() method, passing it an extended Backbone view\r\n    // to render each individual attachment. \r\n    buildAttachments: function() {\r\n        var attachments_collection_view = new Backbone.View.Attachments({\r\n            model: this.model,\r\n            view: this.options.attachmentView\r\n        })\r\n        var attachments_view_element = attachments_collection_view.render().el\r\n        return attachments_view_element\r\n    }\r\n})\r\n"]],"start1":0,"start2":0,"length1":0,"length2":7021}]],"length":7021,"saved":false}
{"ts":1362092417730,"patch":[[{"diffs":[[0,"on(resp) {\r\n"],[1,"        \r\n"],[0,"        var "]],"start1":653,"start2":653,"length1":24,"length2":34},{"diffs":[[0,"      }, this)\r\n"],[1,"        console.log(parsed_attachments)\r\n"],[0,"        this._at"]],"start1":960,"start2":960,"length1":32,"length2":73}]],"length":7072,"saved":false}
{"ts":1362092526188,"patch":[[{"diffs":[[0,"nt_id = "],[-1,"id"],[1,"type"],[0," + \"-\" +"]],"start1":5979,"start2":5979,"length1":18,"length2":20},{"diffs":[[0,"+ \"-\" + "],[-1,"type"],[1,"id"],[0,";\r\n     "]],"start1":5992,"start2":5992,"length1":20,"length2":18}]],"length":7072,"saved":false}
{"ts":1362092564687,"patch":[[{"diffs":[[0,"nder()\r\n"],[1,"            console.log(subview)\r\n"],[0,"        "]],"start1":6274,"start2":6274,"length1":16,"length2":50}]],"length":7106,"saved":false}
{"ts":1362092589732,"patch":[[{"diffs":[[0,"s)\r\n"],[-1,"        console.log(parsed_attachments)\r\n"],[0,"    "]],"start1":972,"start2":972,"length1":49,"length2":8}]],"length":7065,"saved":false}
{"ts":1362092620707,"patch":[[{"diffs":[[0,"    "],[-1,"console.log(subview)"],[0,"\r\n  "]],"start1":6249,"start2":6249,"length1":28,"length2":8}]],"length":7045,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362339578413,"patch":[[{"diffs":[[0,"extend({"],[-1,"\r\n"],[0,"})\r\n\r\nBa"]],"start1":43,"start2":43,"length1":18,"length2":16},{"diffs":[[0," = [];\r\n"],[-1,"        "],[1,""],[0,"\r\n      "]],"start1":361,"start2":361,"length1":24,"length2":16},{"diffs":[[0,"esp) {\r\n"],[-1,"        \r\n"],[0,"        "]],"start1":647,"start2":647,"length1":26,"length2":16},{"diffs":[[0,"    },\r\n"],[-1,"    "],[1,""],[0,"\r\n    ad"]],"start1":1168,"start2":1168,"length1":20,"length2":16},{"diffs":[[0,"_id)\r\n    },"],[-1,"    "],[1,""],[0,"\r\n    sync: "]],"start1":1651,"start2":1651,"length1":28,"length2":24},{"diffs":[[0,"};\r\n"],[-1,"            var attachments = this._attachments.filter(function(attachment) {\r\n                return attachment.get(\"binary\");\r\n            });\r\n"],[0,"    "]],"start1":2385,"start2":2385,"length1":154,"length2":8},{"diffs":[[0,"    if ("],[-1,""],[1,"this._"],[0,"attachme"]],"start1":2483,"start2":2483,"length1":16,"length2":22},{"diffs":[[0,"r = 0;\r\n"],[1,"\r\n"],[0,"        "]],"start1":2772,"start2":2772,"length1":16,"length2":18},{"diffs":[[0,"    "],[-1,"_.each("],[1,"this._"],[0,"atta"]],"start1":2790,"start2":2790,"length1":15,"length2":14},{"diffs":[[0,"his._attachments"],[-1,", "],[1,".each("],[0,"function(attachm"]],"start1":2795,"start2":2795,"length1":34,"length2":38},{"diffs":[[0,"(attachment) {\r\n"],[-1,"\r\n"],[1,"                if (attachment.get(\"binary\")) {\r\n    "],[0,"                "]],"start1":2825,"start2":2825,"length1":34,"length2":85},{"diffs":[[0,"                "],[1,"    "],[0,"fReader.onload ="]],"start1":2943,"start2":2943,"length1":32,"length2":36},{"diffs":[[0,"ent) {\r\n"],[-1,"\r\n"],[1,"  "],[0,"        "]],"start1":2991,"start2":2991,"length1":18,"length2":18},{"diffs":[[0,"        "],[1,"  "],[0,"counter+"]],"start1":3013,"start2":3013,"length1":16,"length2":18},{"diffs":[[0,"ter++;\r\n"],[1,"    "],[0,"        "]],"start1":3027,"start2":3027,"length1":16,"length2":20},{"diffs":[[0,"                "],[1,"    "],[0,"json._attachment"]],"start1":3110,"start2":3110,"length1":32,"length2":36},{"diffs":[[0,"nt.id] = {\r\n"],[1,"    "],[0,"            "]],"start1":3156,"start2":3156,"length1":24,"length2":28},{"diffs":[[0,"        "],[1,"    "],[0,"data: da"]],"start1":3259,"start2":3259,"length1":16,"length2":20},{"diffs":[[0,"                "],[1,"    "],[0,"}\r\n             "]],"start1":3287,"start2":3287,"length1":32,"length2":36},{"diffs":[[0,"    "],[-1,"if (counter == attachments.length)"],[1,"}\r\n                    fReader.readAsDataURL(attachment.get(\"binary\"))\r\n                }\r\n                else {\r\n                    counter++;\r\n                    json._attachments[attachment.id] ="],[0," {\r\n"]],"start1":3326,"start2":3326,"length1":42,"length2":209},{"diffs":[[0,"    "],[-1,"callback(json);"],[1,"stub: true"],[0,"\r\n  "]],"start1":3555,"start2":3555,"length1":23,"length2":18},{"diffs":[[0,"    "],[-1,"fReader.readAsDataURL(attachment.get(\"binary\"))\r\n            }"],[1,"if (counter == this._attachments.length) {\r\n                    console.log(\"Finished\")\r\n                    callback(json);\r\n                }\r\n            }, this"],[0,")\r\n "]],"start1":3625,"start2":3625,"length1":70,"length2":172},{"diffs":[[0," this)\r\n"],[-1,"        "],[0,"        "]],"start1":5498,"start2":5498,"length1":24,"length2":16},{"diffs":[[0,"rtable({"],[1,"\r\n            "],[0,"update: "]],"start1":5525,"start2":5525,"length1":16,"length2":30},{"diffs":[[0,"ent,"],[1," "],[0,"ui) {\r\n"],[1,"\r\n"],[0,"    "],[-1,"               \r\n"],[0,"    "]],"start1":5566,"start2":5566,"length1":36,"length2":22},{"diffs":[[0,"        "],[1,"}\r\n"],[0,"    "],[-1,"}"],[1,"    "],[0,"})\r\n    "]],"start1":5667,"start2":5667,"length1":21,"length2":27},{"diffs":[[0,"\r\n    },"],[-1,"    "],[1,""],[0,"\r\n    _r"]],"start1":5892,"start2":5892,"length1":20,"length2":16},{"diffs":[[0,"nt_id = "],[-1,"type"],[1,"id"],[0," + \"-\" +"]],"start1":6110,"start2":6110,"length1":20,"length2":18},{"diffs":[[0,"+ \"-\" + "],[-1,"id"],[1,"type"],[0,";\r\n     "]],"start1":6121,"start2":6121,"length1":18,"length2":20},{"diffs":[[0,"()\r\n"],[-1,"            \r\n"],[0,"    "]],"start1":6409,"start2":6409,"length1":22,"length2":8},{"diffs":[[0,"nction() {\r\n"],[1," "],[0,"       this."]],"start1":6604,"start2":6604,"length1":24,"length2":25}]],"length":7204,"saved":false}
{"ts":1362339760868,"patch":[[{"diffs":[[0,"y, list) {\r\n"],[1,"            \r\nconsole.log(key)\r\n"],[0,"            "]],"start1":765,"start2":765,"length1":24,"length2":56}]],"length":7236,"saved":false}
{"ts":1362339867326,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"console.log(key)\r\n"],[0,"    "]],"start1":787,"start2":787,"length1":26,"length2":8},{"diffs":[[0,"it(\"-\")["],[-1,"0"],[1,"1"],[0,"]) + 1;\r"]],"start1":1427,"start2":1427,"length1":17,"length2":17},{"diffs":[[0,"    id: "],[-1,"new_id"],[1,"type"],[0," + \"-\" +"]],"start1":1552,"start2":1552,"length1":22,"length2":20},{"diffs":[[0,"+ \"-\" + "],[-1,"type"],[1,"new_id"],[0,"\r\n      "]],"start1":1565,"start2":1565,"length1":20,"length2":22}]],"length":7218,"saved":false}
{"ts":1362339956477,"patch":[[{"diffs":[[0,") + 1;\r\n"],[-1,"\r\n"],[0,"        "]],"start1":1437,"start2":1437,"length1":18,"length2":16},{"diffs":[[0,"id ="],[-1," id + \"-\" + type"],[1,"type+\"-\"  id + "],[0,";\r\n "]],"start1":6125,"start2":6125,"length1":24,"length2":23}]],"length":7215,"saved":false}
{"ts":1362339958901,"patch":[[{"diffs":[[0,"\"-\" "],[1,"+"],[0," id"],[-1," + "],[0,";\r\n "]],"start1":6134,"start2":6134,"length1":14,"length2":12}]],"length":7213,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362340411670,"patch":[[{"diffs":[[0,"n split["],[-1,"0"],[1,"1"],[0,"];\r\n    "]],"start1":1362,"start2":1362,"length1":17,"length2":17}]],"length":7213,"saved":false}
{"ts":1362340447649,"patch":[[{"diffs":[[0," + id;\r\n"],[1,"            console.log(attachment_id)\r\n"],[0,"        "]],"start1":6137,"start2":6137,"length1":16,"length2":56}]],"length":7253,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362403751472,"patch":[[{"diffs":[[0,"            "],[-1,""],[0,""],[1,"var attach = attachment;\r\n               "],[0," if (attachm"]],"start1":2856,"start2":2856,"length1":24,"length2":65},{"diffs":[[0,"eReader();\r\n"],[1,"                    var that = this;\r\n"],[0,"            "]],"start1":2984,"start2":2984,"length1":24,"length2":62},{"diffs":[[0,"t(\",\")[1];\r\n"],[1,"                        console.log(attachment)\r\n"],[0,"            "]],"start1":3185,"start2":3185,"length1":24,"length2":73},{"diffs":[[0,"tachments[attach"],[-1,"ment"],[0,".id] = {\r\n      "]],"start1":3278,"start2":3278,"length1":36,"length2":32},{"diffs":[[0,"type: attach"],[-1,"ment"],[0,".get(\"conten"]],"start1":3340,"start2":3340,"length1":28,"length2":24},{"diffs":[[0,": data\r\n        "],[1,"    "],[1,"            }\r\n                        \r\n                if (counter == that._attachments.length) {\r\n                    console.log(\"Finished\")\r\n                    callback(json);\r\n"],[0,"                "]],"start1":3407,"start2":3407,"length1":32,"length2":219},{"diffs":[[0,"    counter++;\r\n"],[1,"                    \r\n                    console.log(counter, \"mid\", this._attachments.length)\r\n"],[0,"                "]],"start1":3780,"start2":3780,"length1":32,"length2":129},{"diffs":[[0,"       });\r\n"],[-1,""],[0,""],[1,"        this.on(\"sync\", this.render, this)"],[0,"\r\n        //"]],"start1":4743,"start2":4743,"length1":24,"length2":66},{"diffs":[[0,".files[0];\r\n"],[1,"            console.log(\"src element\", $(e.srcElement).id);\r\n"],[0,"            "]],"start1":5070,"start2":5070,"length1":24,"length2":85},{"diffs":[[0,"type"],[-1,",\r\n                id: e.srcElement.id\r\n            });\r\n        });\r\n        this.listenTo(this.model, \"destroy\", this.remove"],[1,"\r\n            });\r\n        }"],[0,");\r\n"]],"start1":5239,"start2":5239,"length1":134,"length2":36},{"diffs":[[0,"t, ui) {"],[-1,"\r\n"],[0,""],[1,""],[0,"\r\n      "]],"start1":5989,"start2":5989,"length1":18,"length2":16}]],"length":7660,"saved":false}
{"ts":1362403905014,"patch":[[{"diffs":[[0,");\r\n"],[-1,"        this.on(\"sync\", this.render, this)\r\n"],[0,"    "]],"start1":4751,"start2":4751,"length1":52,"length2":8},{"diffs":[[0,": function() {\r\n"],[1,"        \r\n        this.model._attachments.on(\"sync\", this.render, this)\r\n"],[0,"        this.mod"]],"start1":5310,"start2":5310,"length1":32,"length2":105}]],"length":7689,"saved":false}
{"ts":1362403958902,"patch":[[{"diffs":[[0,": function() {\r\n"],[1,"        console.log(\"Rendering attachments\")\r\n"],[0,"        var that"]],"start1":5753,"start2":5753,"length1":32,"length2":78}]],"length":7735,"saved":false}
{"ts":1362404097366,"patch":[[{"diffs":[[0," {\r\n"],[-1,"            console.log(\"updagte\")\r\n"],[0,"    "]],"start1":6235,"start2":6235,"length1":44,"length2":8}]],"length":7699,"saved":false}
{"ts":1362404100153,"patch":[[{"diffs":[[0," this.model."],[-1,"_attachments."],[0,"on(\"sync\", t"]],"start1":5343,"start2":5343,"length1":37,"length2":24}]],"length":7686,"saved":false}
{"ts":1362405152116,"patch":[[{"diffs":[[0,"ments\"\r\n"],[1,"        console.log(this._attachments.url)\r\n"],[0,"        "]],"start1":1095,"start2":1095,"length1":16,"length2":60}]],"length":7730,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362405198359,"patch":[[{"diffs":[[0,"];\r\n"],[-1,"                        console.log(attachment)\r\n"],[0,"    "]],"start1":3237,"start2":3237,"length1":57,"length2":8},{"diffs":[[0,"+;\r\n"],[-1,"                    \r\n                    console.log(counter, \"mid\", this._attachments.length)\r\n"],[0,"    "]],"start1":3787,"start2":3787,"length1":105,"length2":8},{"diffs":[[0," {\r\n"],[-1,"                    console.log(\"Finished\")\r\n"],[0,"    "]],"start1":3983,"start2":3983,"length1":53,"length2":8}]],"length":7539,"saved":false}
{"ts":1362405215816,"patch":[[{"diffs":[[0,"];\r\n"],[-1,"            console.log(\"src element\", $(e.srcElement).id);\r\n"],[0,"    "]],"start1":4887,"start2":4887,"length1":69,"length2":8},{"diffs":[[0,"odel.set({\r\n"],[1,""],[0,"            "]],"start1":4909,"start2":4909,"length1":24,"length2":24},{"diffs":[[0," {\r\n"],[-1,"        console.log(\"Rendering attachments\")\r\n"],[0,"    "]],"start1":5544,"start2":5544,"length1":54,"length2":8},{"diffs":[[0,"nction(type) {\r\n"],[1,""],[0,"            var "]],"start1":6261,"start2":6261,"length1":32,"length2":32},{"diffs":[[0,"d;\r\n"],[-1,"            console.log(attachment_id)\r\n"],[0,"    "]],"start1":6320,"start2":6320,"length1":48,"length2":8}]],"length":7392,"saved":false}
{"ts":1362405680495,"patch":[[{"diffs":[[0,"og(this."],[-1,"_attachments."],[0,"url"],[1,"()"],[0,")\r\n     "]],"start1":1120,"start2":1120,"length1":32,"length2":21}]],"length":7381,"saved":false}
{"ts":1362405740534,"patch":[[{"diffs":[[0,"() +"],[-1," \"/\" + resp._id +"],[0," \"/a"]],"start1":1065,"start2":1065,"length1":25,"length2":8}]],"length":7364,"saved":false}
{"ts":1362405826867,"patch":[[{"diffs":[[0,"tachment"],[1,",\r\n    url: function() {\r\n        return this.model.url() + \"/attachments\"\r\n    }"],[0,"\r\n})\r\n\r\n"]],"start1":149,"start2":149,"length1":16,"length2":97},{"diffs":[[0,"\r\n\r\n"],[-1,"        this._attachments.url = this.url() + \"/attachments\"\r\n"],[0,"    "]],"start1":1102,"start2":1102,"length1":69,"length2":8}]],"length":7384,"saved":false}
{"ts":1362405840689,"patch":[[{"diffs":[[0,"odel.url"],[-1,"() "],[0,"+ \"/atta"]],"start1":204,"start2":204,"length1":19,"length2":16}]],"length":7381,"saved":false}
{"ts":1362405927053,"patch":[[{"diffs":[[0,"odel.url"],[1,"()"],[0,"+ \"/atta"]],"start1":204,"start2":204,"length1":16,"length2":18}]],"length":7383,"saved":false}
{"ts":1362405993115,"patch":[[{"diffs":[[0,"rn this."],[-1,"model"],[1,"collection"],[0,".url()+ "]],"start1":195,"start2":195,"length1":21,"length2":26}]],"length":7388,"saved":false}
{"ts":1362406018044,"patch":[[{"diffs":[[0,"rn this."],[-1,"collection"],[1,"parent"],[0,".url()+ "]],"start1":195,"start2":195,"length1":26,"length2":22}]],"length":7384,"saved":false}
{"ts":1362406025058,"patch":[[{"diffs":[[0,"ments)\r\n"],[1,"        this._attachments.paret = this;"],[0,"\r\n      "]],"start1":1096,"start2":1096,"length1":16,"length2":55}]],"length":7423,"saved":false}
{"ts":1362406027118,"patch":[[{"diffs":[[0,"nts.pare"],[1,"n"],[0,"t = this"]],"start1":1126,"start2":1126,"length1":16,"length2":17}]],"length":7424,"saved":false}
{"ts":1362406118525,"patch":[[{"diffs":[[0," = [];\r\n"],[-1,"\r\n"],[0,"        "]],"start1":442,"start2":442,"length1":18,"length2":16},{"diffs":[[0,"ist) {\r\n"],[-1,"            \r\n"],[0,"        "]],"start1":848,"start2":848,"length1":30,"length2":16},{"diffs":[[0,"s;\r\n"],[-1,"        console.log(this.url())\r\n"],[0,"    "]],"start1":1126,"start2":1126,"length1":41,"length2":8}]],"length":7375,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362415121515,"patch":[[{"diffs":[[0,"    "],[-1,"this.attachments_order = [];\r\n        Backbone.Model.apply(this, arguments)"],[1,"Backbone.Model.apply(this, arguments)\r\n        \r\n        this.attachments_order = [];"],[0,"\r\n  "]],"start1":416,"start2":416,"length1":83,"length2":93}]],"length":7385,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362415179419,"patch":[[{"diffs":[[0,"tachments;\r\n"],[1,"        \r\n        this.attachments_order = [];\r\n"],[0,"        Back"]],"start1":400,"start2":400,"length1":24,"length2":72},{"diffs":[[0,"  \r\n"],[-1,"        this.attachments_order = [];\r\n"],[0,"    "]],"start1":513,"start2":513,"length1":46,"length2":8}]],"length":7395,"saved":false}
{"ts":1362415231782,"patch":[[{"diffs":[[0,"    "],[-1,"this.attachments_order = [];\r\n        Backbone.Model.apply(this, arguments)"],[1,"Backbone.Model.apply(this, arguments)\r\n        \r\n        this.attachments_order = this.attachments_order || [];"],[0,"\r\n  "]],"start1":426,"start2":426,"length1":83,"length2":119}]],"length":7431,"saved":false}
{"ts":1362415608501,"patch":[[{"diffs":[[0,": function() {\r\n"],[1,"        \r\n"],[0,"        var max "]],"start1":1297,"start2":1297,"length1":32,"length2":42},{"diffs":[[0,"];\r\n        })\r\n"],[1,"        max = max || 1;\r\n"],[0,"        var new_"]],"start1":1464,"start2":1464,"length1":32,"length2":57}]],"length":7466,"saved":false}
{"ts":1362415628758,"patch":[[{"diffs":[[0,"    "],[-1,"max = max || 1;"],[1,"if (max) {"],[0,"\r\n  "]],"start1":1484,"start2":1484,"length1":23,"length2":18},{"diffs":[[0,") + 1;\r\n"],[1,"        }\r\n        else {\r\n            var new_id = 1\r\n        }\r\n"],[0,"        "]],"start1":1550,"start2":1550,"length1":16,"length2":82}]],"length":7527,"saved":false}
{"ts":1362416773277,"patch":[[{"diffs":[[0,"id ="],[1," "],[0,"type"],[-1,"+"],[1," + "],[0,"\"-\" "]],"start1":6439,"start2":6439,"length1":13,"length2":16}]],"length":7530,"saved":false}
{"ts":1362416996714,"patch":[[{"diffs":[[0,"tributes);\r\n"],[1,"        json._id = json.name;\r\n"],[0,"        if ("]],"start1":2486,"start2":2486,"length1":24,"length2":55}]],"length":7561,"saved":false}
{"ts":1362417004837,"patch":[[{"diffs":[[0,"   json."],[-1,"_"],[0,"id = jso"]],"start1":2503,"start2":2503,"length1":17,"length2":16}]],"length":7560,"saved":false}
{"ts":1362417283526,"patch":[[{"diffs":[[0,"   json."],[1,"_"],[0,"id = jso"]],"start1":2503,"start2":2503,"length1":16,"length2":17}]],"length":7561,"saved":false}
{"ts":1362417324885,"patch":[[{"diffs":[[0,");\r\n"],[-1,"        json._id = json.name;\r\n"],[0,"    "]],"start1":2494,"start2":2494,"length1":39,"length2":8}]],"length":7530,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362420727029,"patch":[[{"diffs":[[0,"ments;\r\n        "],[1,"this._attachments.parent = this;"],[0,"\r\n"],[-1,""],[0,"        Backbone"]],"start1":404,"start2":404,"length1":34,"length2":66},{"diffs":[[0,"ments)\r\n"],[-1,"        \r\n"],[0,"        "]],"start1":493,"start2":493,"length1":26,"length2":16},{"diffs":[[0,"      \r\n    },\r\n"],[1,"    url: function() {\r\n       var url = Backbone.Model.url.apply(this, arguments)\r\n       console.log(url);\r\n       return url;\r\n    }\r\n"],[0,"    // We overwr"]],"start1":567,"start2":567,"length1":32,"length2":168},{"diffs":[[0,"s)\r\n"],[-1,"        this._attachments.parent = this;\r\n"],[0,"    "]],"start1":1298,"start2":1298,"length1":50,"length2":8},{"diffs":[[0,"      }, this)\r\n"],[1,"        this.attachments_order.push(new_id)\r\n"],[0,"        this._at"]],"start1":1892,"start2":1892,"length1":32,"length2":77},{"diffs":[[0,"gth > 0) {\r\n"],[-1,""],[0,"            "]],"start1":2692,"start2":2692,"length1":24,"length2":24},{"diffs":[[0," = {};\r\n"],[1,"            json.attachments_order = this.attachments_order;\r\n"],[0,"        "]],"start1":2733,"start2":2733,"length1":16,"length2":78},{"diffs":[[0,"     that.model."],[-1,"set(\""],[0,"attachments_orde"]],"start1":6176,"start2":6176,"length1":37,"length2":32},{"diffs":[[0,"ttachments_order"],[-1,"\","],[1," ="],[0," $(this).sortabl"]],"start1":6193,"start2":6193,"length1":34,"length2":34},{"diffs":[[0,"table(\"toArray\")"],[-1,")"],[0,";\r\n            }"]],"start1":6223,"start2":6223,"length1":33,"length2":32},{"diffs":[[0,"del."],[-1,"set(\""],[0,"atta"]],"start1":6343,"start2":6343,"length1":13,"length2":8},{"diffs":[[0,"ts_order"],[-1,"\","],[1," ="],[0," $(this)"]],"start1":6356,"start2":6356,"length1":18,"length2":18},{"diffs":[[0,"oArray\")"],[-1,")"],[0,";\r\n     "]],"start1":6386,"start2":6386,"length1":17,"length2":16}]],"length":7741,"saved":false}
{"ts":1362420743931,"patch":[[{"diffs":[[0," url;\r\n    }"],[1,","],[0,"\r\n    // We "]],"start1":705,"start2":705,"length1":24,"length2":25}]],"length":7742,"saved":false}
{"ts":1362420799576,"patch":[[{"diffs":[[0,"nction() {\r\n"],[1,"        console.log(Backbone.Model.url)\r\n"],[0,"       var u"]],"start1":594,"start2":594,"length1":24,"length2":65}]],"length":7783,"saved":false}
{"ts":1362420821601,"patch":[[{"diffs":[[0,"odel.url"],[1,"()"],[0,")\r\n     "]],"start1":636,"start2":636,"length1":16,"length2":18}]],"length":7785,"saved":false}
{"ts":1362420895868,"patch":[[{"diffs":[[0,"odel.url"],[1,"()"],[0,".apply(t"]],"start1":676,"start2":676,"length1":16,"length2":18}]],"length":7787,"saved":false}
{"ts":1362420897821,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        console.log(Backbone.Model.url())\r\n"],[0,"    "]],"start1":602,"start2":602,"length1":51,"length2":8}]],"length":7744,"saved":false}
{"ts":1362420916501,"patch":[[{"diffs":[[0,"del."],[-1,"url()."],[0,"appl"]],"start1":634,"start2":634,"length1":14,"length2":8}]],"length":7738,"saved":false}
{"ts":1362420928664,"patch":[[{"diffs":[[0," Backbone.Model."],[1,"url."],[0,"apply(this, argu"]],"start1":622,"start2":622,"length1":32,"length2":36}]],"length":7742,"saved":false}
{"ts":1362421141792,"patch":[[{"diffs":[[0,"l = "],[-1,"Backbone.Model.url.apply(this, arguments)"],[1,"__super__.url();"],[0,"\r\n  "]],"start1":619,"start2":619,"length1":49,"length2":24}]],"length":7717,"saved":false}
{"ts":1362421156021,"patch":[[{"diffs":[[0,"r url = "],[1,"this."],[0,"__super_"]],"start1":615,"start2":615,"length1":16,"length2":21}]],"length":7722,"saved":false}
{"ts":1362421173616,"patch":[[{"diffs":[[0,"l = "],[-1,"this.__super__"],[1,"Backbone.Model"],[0,".url"]],"start1":619,"start2":619,"length1":22,"length2":22}]],"length":7722,"saved":false}
{"ts":1362421214410,"patch":[[{"diffs":[[0,"e.Model."],[1,"prototype."],[0,"url();\r\n"]],"start1":630,"start2":630,"length1":16,"length2":26}]],"length":7732,"saved":false}
{"ts":1362421230744,"patch":[[{"diffs":[[0,"type.url"],[-1,"();"],[1,".apply(this, arguments)"],[0,"\r\n      "]],"start1":643,"start2":643,"length1":19,"length2":39}]],"length":7752,"saved":false}
{"ts":1362421248016,"patch":[[{"diffs":[[0,".log(url"],[1," + this._rev"],[0,");\r\n    "]],"start1":690,"start2":690,"length1":16,"length2":28}]],"length":7764,"saved":false}
{"ts":1362421286094,"patch":[[{"diffs":[[0,"his."],[1,"get(\""],[0,"_rev"],[1,"\""],[0,");\r\n"]],"start1":702,"start2":702,"length1":12,"length2":18}]],"length":7770,"saved":false}
{"ts":1362421291507,"patch":[[{"diffs":[[0,"(\"_rev\")"],[1,")"],[0,";\r\n     "]],"start1":709,"start2":709,"length1":16,"length2":17}]],"length":7771,"saved":false}
{"ts":1362421314710,"patch":[[{"diffs":[[0,"\n       "],[-1,"console.log("],[1,"return "],[0,"url + th"]],"start1":675,"start2":675,"length1":28,"length2":23},{"diffs":[[0,"ev\")"],[-1,");\r\n       return url"],[0,";\r\n "]],"start1":708,"start2":708,"length1":29,"length2":8}]],"length":7745,"saved":false}
{"ts":1362421320692,"patch":[[{"diffs":[[0,"rn url +"],[1," \"--\" +"],[0," this.ge"]],"start1":687,"start2":687,"length1":16,"length2":23}]],"length":7752,"saved":false}
{"ts":1362428970363,"patch":[[{"diffs":[[0,"|| [];\r\n"],[-1,"        \r\n"],[0,"    },\r\n"]],"start1":557,"start2":557,"length1":26,"length2":16},{"diffs":[[0,"nction() {\r\n"],[-1,"        \r\n"],[0,"        var "]],"start1":1418,"start2":1418,"length1":34,"length2":24}]],"length":7732,"saved":false}
{"ts":1362429476157,"patch":[[{"diffs":[[0,"arguments)\r\n"],[1,"       if(this.isNew() {\r\n           return url;\r\n       }) else {\r\n"],[0,"       retur"]],"start1":654,"start2":654,"length1":24,"length2":92},{"diffs":[[0,"t(\"_rev\");\r\n"],[1,"       }\r\n"],[0,"    },\r\n    "]],"start1":768,"start2":768,"length1":24,"length2":34},{"diffs":[[0,"on() {\r\n"],[-1,"        \r\n"],[0,"        "]],"start1":5537,"start2":5537,"length1":26,"length2":16}]],"length":7800,"saved":false}
{"ts":1362429479261,"patch":[[{"diffs":[[0,".isNew()"],[1,")"],[0," {\r\n    "]],"start1":680,"start2":680,"length1":16,"length2":17}]],"length":7801,"saved":false}
{"ts":1362429487940,"patch":[[{"diffs":[[0,"       }"],[-1,")"],[0," else {\r"]],"start1":717,"start2":717,"length1":17,"length2":16}]],"length":7800,"saved":false}
{"ts":1362429640018,"patch":[[{"diffs":[[0,"    "],[-1,"if("],[0,"this"]],"start1":669,"start2":669,"length1":11,"length2":8},{"diffs":[[0,"sNew"],[-1,"()) {\r\n           return url;\r\n       } else {\r\n       return "],[1," ? return url : ("],[0,"url "]],"start1":679,"start2":679,"length1":70,"length2":25},{"diffs":[[0,"(\"_rev\")"],[1,")"],[0,";\r\n     "]],"start1":721,"start2":721,"length1":16,"length2":17}]],"length":7753,"saved":false}
{"ts":1362429643380,"patch":[[{"diffs":[[0,"ev\"));\r\n"],[-1,"       }\r\n"],[0,"    },\r\n"]],"start1":725,"start2":725,"length1":26,"length2":16}]],"length":7743,"saved":false}
{"ts":1362429697567,"patch":[[{"diffs":[[0,"nts)\r\n      "],[1," url ="],[0," this.isNew "]],"start1":660,"start2":660,"length1":24,"length2":30},{"diffs":[[0,"ew ?"],[-1," return"],[0," url : "],[-1,"("],[0,"url "]],"start1":687,"start2":687,"length1":23,"length2":15},{"diffs":[[0,"(\"_rev\")"],[-1,")"],[0,";\r\n    }"]],"start1":719,"start2":719,"length1":17,"length2":16}]],"length":7740,"saved":false}
{"ts":1362429715174,"patch":[[{"diffs":[[0,"\n       "],[-1,"url ="],[1,"return"],[0," this.is"]],"start1":665,"start2":665,"length1":21,"length2":22},{"diffs":[[0,"? url : "],[1,"("],[0,"url + \"-"]],"start1":691,"start2":691,"length1":16,"length2":17},{"diffs":[[0,"(\"_rev\")"],[1,")"],[0,";\r\n    }"]],"start1":721,"start2":721,"length1":16,"length2":17}]],"length":7743,"saved":false}
{"ts":1362429781872,"patch":[[{"diffs":[[0," }\r\n"],[-1,"                        \r\n"],[0,"    "]],"start1":3803,"start2":3803,"length1":34,"length2":8},{"diffs":[[0," {\r\n"],[-1,"                    console.log(\"Finished\")\r\n"],[0,"    "]],"start1":3863,"start2":3863,"length1":53,"length2":8}]],"length":7672,"saved":false}
{"ts":1362431548597,"patch":[[{"diffs":[[0,"chmentView\r\n"],[1,"            groupEl: this.options.groupEl\r\n"],[0,"        })\r\n"]],"start1":7516,"start2":7516,"length1":24,"length2":67}]],"length":7715,"saved":false}
{"ts":1362431610348,"patch":[[{"diffs":[[0,"$('<"],[-1,"div></div"],[1,"'+this.optionsgroupEl + '></'+this.optious.groupEl +'"],[0,">', "]],"start1":6439,"start2":6439,"length1":17,"length2":61}]],"length":7759,"saved":false}
{"ts":1362431614653,"patch":[[{"diffs":[[0,".options"],[1,"."],[0,"groupEl "]],"start1":6449,"start2":6449,"length1":16,"length2":17}]],"length":7760,"saved":false}
{"ts":1362431748686,"patch":[[{"diffs":[[0,"is.optio"],[-1,"u"],[1,"n"],[0,"s.groupE"]],"start1":6476,"start2":6476,"length1":17,"length2":17}]],"length":7760,"saved":false}
{"ts":1362431787182,"patch":[[{"diffs":[[0,"mentView"],[1,","],[0,"\r\n      "]],"start1":7563,"start2":7563,"length1":16,"length2":17}]],"length":7761,"saved":false}
{"ts":1362431922965,"patch":[[{"diffs":[[0,"ments: function("],[1,"options"],[0,") {\r\n        var"]],"start1":7398,"start2":7398,"length1":32,"length2":39},{"diffs":[[0,"    "],[-1,"var attachments_collection_view = new Backbone.View.Attachments({\r\n            "],[1,"options."],[0,"model"],[-1,":"],[1," ="],[0," thi"]],"start1":7430,"start2":7430,"length1":93,"length2":23},{"diffs":[[0,"    "],[-1,"    "],[1,"options."],[0,"view"],[-1,":"],[1," ="],[0," thi"]],"start1":7467,"start2":7467,"length1":17,"length2":22},{"diffs":[[0,"    "],[-1,"    groupEl: this.options.groupEl\r\n        }"],[1,"var attachments_collection_view = new Backbone.View.Attachments("],[0,")\r\n "]],"start1":7520,"start2":7520,"length1":52,"length2":72}]],"length":7723,"saved":false}
{"ts":1362431943767,"patch":[[{"diffs":[[0,"ion(options) {\r\n"],[1,"        options = options || {}\r\n"],[0,"        options."]],"start1":7410,"start2":7410,"length1":32,"length2":65},{"diffs":[[0,"chments("],[1,"options"],[0,")\r\n     "]],"start1":7613,"start2":7613,"length1":16,"length2":23}]],"length":7763,"saved":false}
{"ts":1362431948510,"patch":[[{"diffs":[[0,"is.model"],[-1,","],[0,"\r\n      "]],"start1":7485,"start2":7485,"length1":17,"length2":16},{"diffs":[[0,"mentView"],[-1,","],[0,"\r\n      "]],"start1":7537,"start2":7537,"length1":17,"length2":16}]],"length":7761,"saved":false}
{"ts":1362433560115,"patch":[[{"diffs":[[0,"];\r\n    },\r\n"],[1,"    \r\n    // Splits the url so that it is the id and the revision,\r\n    // concatenated but delimited by two dashes --\r\n"],[0,"    url: fun"]],"start1":561,"start2":561,"length1":24,"length2":144}]],"length":7881,"saved":false}
{"ts":1362433564223,"patch":[[{"diffs":[[0," [];\r\n    },"],[-1,"\r\n"],[0,"    \r\n    //"]],"start1":559,"start2":559,"length1":26,"length2":24}]],"length":7879,"saved":false}
{"ts":1362434242917,"patch":[[{"diffs":[[0,".files[0];\r\n"],[1,"            this.model.trigger(\"change\")\r\n"],[0,"            "]],"start1":5296,"start2":5296,"length1":24,"length2":66}]],"length":7921,"saved":false}
{"ts":1362434246517,"patch":[[{"diffs":[[0,"          th"],[-1,"is"],[1,"at"],[0,".model.trigg"]],"start1":5310,"start2":5310,"length1":26,"length2":26}]],"length":7921,"saved":false}
{"ts":1362434270487,"patch":[[{"diffs":[[0,".files[0];\r\n"],[1,"            console.log(\"Changing\")\r\n"],[0,"            "]],"start1":5296,"start2":5296,"length1":24,"length2":61}]],"length":7958,"saved":false}
{"ts":1362434300382,"patch":[[{"diffs":[[0,"];\r\n"],[-1,"            console.log(\"Changing\")\r\n            that.model.trigger(\"change\")\r\n"],[0,"    "]],"start1":5304,"start2":5304,"length1":87,"length2":8}]],"length":7879,"saved":false}
{"ts":1362441529217,"patch":[[{"diffs":[[0,"extend({"],[1,"\r\n    url: function() {\r\n        if (this.get(\"dataURL\")) {\r\n            return this.get(\"dataURL\")\r\n        } else {\r\n            return Backbone.Model.prototype.url.apply(this)\r\n        }\r\n    }"],[0,"})\r\n\r\nBa"]],"start1":43,"start2":43,"length1":16,"length2":212}]],"length":8075,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362478555297,"patch":[[{"diffs":[[0,"    },\r\n"],[-1,"\r\n"],[0,"    addA"]],"start1":1717,"start2":1717,"length1":18,"length2":16},{"diffs":[[0,": function() {\r\n"],[1,"        var new_id;\r\n        if (this._attachments.length === 0) {\r\n           new_id = 1\r\n        }\r\n        else {\r\n    "],[0,"        var max "]],"start1":1747,"start2":1747,"length1":32,"length2":154},{"diffs":[[0,"            "],[1,"   "],[1," "],[0,"var split = "]],"start1":1949,"start2":1949,"length1":24,"length2":28},{"diffs":[[0,"            "],[1,"    "],[0,"return split"]],"start1":2004,"start2":2004,"length1":24,"length2":28},{"diffs":[[0,"it[1];\r\n        "],[1,"    "],[0,"})\r\n        if ("]],"start1":2030,"start2":2030,"length1":32,"length2":36},{"diffs":[[0,"    "],[-1,"   if (max) {\r\n"],[0,"       "],[-1," var "],[0,"new_"]],"start1":2055,"start2":2055,"length1":35,"length2":15},{"diffs":[[0," }\r\n"],[-1,"        else {\r\n            var new_id = 1\r\n        }\r\n"],[0,"    "]],"start1":2119,"start2":2119,"length1":63,"length2":8}]],"length":8132,"saved":false}
{"ts":1362478578161,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        var new_id;\r\n"],[0,"    "]],"start1":1759,"start2":1759,"length1":29,"length2":8},{"diffs":[[0,") {\r\n           "],[1," var "],[0,"new_id = 1\r\n    "]],"start1":1805,"start2":1805,"length1":32,"length2":37},{"diffs":[[0,"        "],[1,"var "],[0,"new_id ="]],"start1":2042,"start2":2042,"length1":16,"length2":20}]],"length":8120,"saved":false}
{"ts":1362478677546,"patch":[[{"diffs":[[0,"p;\r\n    },\r\n"],[1,"    // Add a group of empty attachments based on their types\r\n"],[0,"    addAttac"]],"start1":1713,"start2":1713,"length1":24,"length2":86}]],"length":8182,"saved":false}
{"ts":1362479687257,"patch":[[{"diffs":[[0,"der || [];\r\n"],[1,"        this.attachments_loading_counter = 0;\r\n"],[0,"    },    \r\n"]],"start1":749,"start2":749,"length1":24,"length2":71},{"diffs":[[0,".files[0];\r\n"],[1,"\r\n            var fReader = new FileReader();\r\n            fReader.onload = function(event) {\r\n                var data = event.target.result.split(\",\")[1];\r\n    "],[0,"            "]],"start1":5646,"start2":5646,"length1":24,"length2":186},{"diffs":[[0,"    "],[1,"  "],[-1,"binary: file,\r\n                content_type: file.type\r\n            });"],[1,"  base64: data,\r\n                    dataURL: event.target.result,\r\n                    content_type: file.type\r\n                });\r\n                that.model.collection.parent.trigger(\"file-saved\")\r\n            }\r\n            that.model.collection.parent.attachments_loading_counter++;\r\n            fReader.readAsDataURL(file)"],[0,"\r\n  "]],"start1":5862,"start2":5862,"length1":79,"length2":339}]],"length":8651,"saved":false}
{"ts":1362479730339,"patch":[[{"diffs":[[0,"    "],[-1,"},"],[0,"    "],[1,"this.on(\"file-save\", this.savedFile, this)\r\n    },    \r\n    savedFile: function() {\r\n      alert(\"GO\")  \r\n    },"],[0,"\r\n  "]],"start1":808,"start2":808,"length1":14,"length2":124}]],"length":8761,"saved":false}
{"ts":1362479805547,"patch":[[{"diffs":[[0,"ile-save"],[1,"d"],[0,"\", this."]],"start1":826,"start2":826,"length1":16,"length2":17}]],"length":8762,"saved":false}
{"ts":1362479855303,"patch":[[{"diffs":[[0,"    "],[-1,"alert(\"GO\""],[1,"  console.log(this.attachments_loading_counter"],[0,")  \r"]],"start1":904,"start2":904,"length1":18,"length2":54}]],"length":8798,"saved":false}
{"ts":1362479958397,"patch":[[{"diffs":[[0,"    "],[-1,"console.log(this.attachments_loading_counter)  "],[1,"this.attachments_loading_counter--\r\n        if(this.attachments_loading_counter === 0 && this.waitingForSave) {\r\n            this.waitingForSave();\r\n        }"],[0,"\r\n  "]],"start1":906,"start2":906,"length1":55,"length2":166}]],"length":8909,"saved":false}
{"ts":1362480010406,"patch":[[{"diffs":[[0,": function() {\r\n"],[1,"        console.log(this.attachments_loading_counter)\r\n"],[0,"        var xhr,"]],"start1":2763,"start2":2763,"length1":32,"length2":87},{"diffs":[[0,"ments;\r\n"],[-1,""],[0,"\r\n      "]],"start1":2862,"start2":2862,"length1":16,"length2":16},{"diffs":[[0,"r.\r\n"],[1,""],[0,"   "],[-1," saveForCouchDB: function(callback) {\r\n        var json = _.clone(this.attributes);\r\n        if (this._attachments.length > 0) {\r\n            json._attachments = {};\r\n            json.attachments_order = this.attachments_order;\r\n            // If no files have been added to the model then we return straight away\r\n            if (this._attachments.length === 0) {\r\n                callback(json)\r\n                return;\r\n            }\r\n            // We need to use a counter as loading of the files is asynchronous\r\n            // and we do not want to return until they are all loaded\r\n            var counter = 0;\r\n\r\n            this._attachments.each(function(attachment) {\r\n               var attach = attachment;\r\n                if (attachment.get(\"binary\")) {\r\n                    var fReader = new FileReader();\r\n                    var that = this;\r\n                    fReader.onload = function(event) {\r\n                        counter++;\r\n                        var data = event.target.result.split(\",\")[1];\r\n                        json._attachments[attach.id] = {\r\n                            content_type: attach.get(\"content_type\"),\r\n                            data: data\r\n                        }\r\n                if (counter == that._attachments.length) {\r\n                    callback(json);\r\n                }\r\n                    }\r\n                    fReader.readAsDataURL(attachment.get(\"binary\"))\r\n                }\r\n                else {\r\n                    counter++;\r\n                    json._attachments[attachment.id] = {\r\n                        stub: true\r\n                    }\r\n                }\r\n                if (counter == this._attachments.length) {\r\n                    callback(json);\r\n                }\r\n            }, this)\r\n        }\r\n        else {\r\n            callback(json)\r\n        }\r\n    },"],[0,"\r\n  "]],"start1":3360,"start2":3360,"length1":1861,"length2":11}]],"length":7114,"saved":false}
{"ts":1362483764338,"patch":[[{"diffs":[[0,") {\r\n       "],[-1," if ("],[1,"var dataURL = "],[0,"this.get(\"da"]],"start1":71,"start2":71,"length1":29,"length2":38},{"diffs":[[0,"ataURL\")"],[-1,") {\r\n    "],[1,";\r\n"],[0,"        "]],"start1":108,"start2":108,"length1":25,"length2":19},{"diffs":[[0,"urn "],[-1,"this.get(\"dataURL\")\r\n        } else {\r\n            return"],[1,"dataURL ? dataURL :"],[0," Bac"]],"start1":130,"start2":130,"length1":65,"length2":27},{"diffs":[[0,"(this)\r\n"],[-1,"        }\r\n"],[0,"    }})\r"]],"start1":188,"start2":188,"length1":27,"length2":16},{"diffs":[[0,"    },\r\n"],[-1," \r\n"],[0,"    idAt"]],"start1":3788,"start2":3788,"length1":19,"length2":16}]],"length":7541,"saved":false}
{"ts":1362483788435,"patch":[[{"diffs":[[0,"es, options) {\r\n"],[1,"        Backbone.Model.apply(this, arguments)\r\n        \r\n"],[0,"        this._at"]],"start1":480,"start2":480,"length1":32,"length2":89},{"diffs":[[0,"s;\r\n"],[-1,"        Backbone.Model.apply(this, arguments)\r\n"],[0,"    "]],"start1":657,"start2":657,"length1":55,"length2":8}]],"length":7551,"saved":false}
{"ts":1362483797513,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        Backbone.Model.apply(this, arguments)\r\n        \r\n"],[0,"    "]],"start1":492,"start2":492,"length1":65,"length2":8},{"diffs":[[0,"parent = this;\r\n"],[1,"        Backbone.Model.apply(this, arguments)\r\n"],[0,"        this.att"]],"start1":588,"start2":588,"length1":32,"length2":79}]],"length":7541,"saved":false}
{"ts":1362484573121,"patch":[[{"diffs":[[0," // "],[-1,"Splits the url so that it is the id and the revision,"],[1,"CouchDB models have a revision (_rev) property as well \r\n    // as an _id to identify them. Backbone's standard url() function\r\n    // just returns the id as part of the url. Eg. /products/1"],[0,"\r\n    //"],[1," We"],[0," con"]],"start1":1056,"start2":1056,"length1":69,"length2":209},{"diffs":[[0,"nate"],[-1,"d but delimited by"],[1," the _rev onto the URL of  models which are not\r\n    // new by using with"],[0," two"]],"start1":1269,"start2":1269,"length1":26,"length2":81},{"diffs":[[0," dashes "],[1,"("],[0,"--"],[1,")"],[0,"\r\n    ur"]],"start1":1350,"start2":1350,"length1":18,"length2":20}]],"length":7738,"saved":false}
{"ts":1362484890828,"patch":[[{"diffs":[[0,"and "],[-1,"save it"],[1,"trigger an event on the parent model to \r\n        // say the file has loaded into the browser successfully"],[0,"\r\n  "]],"start1":4594,"start2":4594,"length1":15,"length2":114}]],"length":7837,"saved":false}
{"ts":1362484946491,"patch":[[{"diffs":[[0,"})\r\n"],[-1,"        this.$el.bind(\"update\", function(event, ui) {\r\n            that.model.attachments_order = $(this).sortable(\"toArray\");\r\n        })\r\n"],[0,"    "]],"start1":6272,"start2":6272,"length1":148,"length2":8}]],"length":7697,"saved":false}
{"ts":1362485468609,"patch":[[{"diffs":[[0,"type"],[-1,",\r\n                length: list[key].length,"],[0,"\r\n  "]],"start1":1979,"start2":1979,"length1":52,"length2":8}]],"length":7653,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362486154809,"patch":[[{"diffs":[[0,"del.extend({"],[-1,"\r"],[0,"\n    url: fu"]],"start1":39,"start2":39,"length1":25,"length2":24},{"diffs":[[0,"rl: function() {"],[-1,"\r"],[0,"\n"],[1," "],[0,"       var dataU"]],"start1":57,"start2":57,"length1":34,"length2":34},{"diffs":[[0,"taURL\");"],[-1,"\r"],[0,"\n       "]],"start1":108,"start2":108,"length1":17,"length2":16},{"diffs":[[0,"his)"],[-1,"\r"],[0,"\n    }"],[1,"\n"],[0,"})"],[-1,"\r\n\r"],[1,"\n"],[0,"\nBac"]],"start1":188,"start2":188,"length1":20,"length2":18},{"diffs":[[0,"ion.extend({"],[-1,"\r"],[0,"\n    model: "]],"start1":253,"start2":253,"length1":25,"length2":24},{"diffs":[[0,"achment,"],[-1,"\r"],[0,"\n    url"]],"start1":295,"start2":295,"length1":17,"length2":16},{"diffs":[[0,"rl: function() {"],[-1,"\r"],[0,"\n        return "]],"start1":309,"start2":309,"length1":33,"length2":32},{"diffs":[[0,"nt.url()"],[1," "],[0,"+ \"/atta"]],"start1":350,"start2":350,"length1":16,"length2":17},{"diffs":[[0,"chments\""],[-1,"\r"],[0,"\n    }"],[-1,"\r"],[0,"\n})"],[-1,"\r\n\r"],[1,"\n"],[0,"\nBackbon"]],"start1":367,"start2":367,"length1":30,"length2":26},{"diffs":[[0,"e.Model.extend({"],[-1,"\r"],[0,"\n    constructor"]],"start1":418,"start2":418,"length1":33,"length2":32},{"diffs":[[0,"utes, options) {"],[-1,"\r"],[0,"\n        this._a"]],"start1":467,"start2":467,"length1":33,"length2":32},{"diffs":[[0,"chments;"],[-1,"\r"],[0,"\n       "]],"start1":540,"start2":540,"length1":17,"length2":16},{"diffs":[[0,"s.parent = this;"],[-1,"\r"],[0,"\n        Backbon"]],"start1":573,"start2":573,"length1":33,"length2":32},{"diffs":[[0,"this, arguments)"],[-1,"\r"],[0,"\n        this.at"]],"start1":619,"start2":619,"length1":33,"length2":32},{"diffs":[[0,"r || [];"],[-1,"\r"],[0,"\n       "]],"start1":690,"start2":690,"length1":17,"length2":16},{"diffs":[[0,"ter = 0;"],[-1,"\r"],[0,"\n       "]],"start1":736,"start2":736,"length1":17,"length2":16},{"diffs":[[0,"his)"],[-1,"\r"],[0,"\n    },"],[-1,"    \r"],[0,"\n   "]],"start1":792,"start2":792,"length1":21,"length2":15},{"diffs":[[0,"le: function() {"],[-1,"\r"],[0,"\n        this.at"]],"start1":815,"start2":815,"length1":33,"length2":32},{"diffs":[[0,"ounter--"],[-1,"\r"],[0,"\n       "]],"start1":866,"start2":866,"length1":17,"length2":16},{"diffs":[[0,"      if"],[1," "],[0,"(this.at"]],"start1":877,"start2":877,"length1":16,"length2":17},{"diffs":[[0,"ngForSave) {"],[-1,"\r"],[0,"\n           "]],"start1":939,"start2":939,"length1":25,"length2":24},{"diffs":[[0,"\n           "],[1," this.sync.apply(this,"],[0," this.waitin"]],"start1":951,"start2":951,"length1":24,"length2":46},{"diffs":[[0,"gForSave"],[-1,"("],[0,");"],[-1,"\r"],[0,"\n       "]],"start1":997,"start2":997,"length1":20,"length2":18},{"diffs":[[0,"       }"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n    // "]],"start1":1009,"start2":1009,"length1":25,"length2":23},{"diffs":[[0,"as well "],[-1,"\r"],[0,"\n    // "]],"start1":1079,"start2":1079,"length1":17,"length2":16},{"diffs":[[0,"l() function"],[-1,"\r"],[0,"\n    // just"]],"start1":1145,"start2":1145,"length1":25,"length2":24},{"diffs":[[0,"oducts/1"],[-1,"\r"],[0,"\n    // "]],"start1":1212,"start2":1212,"length1":17,"length2":16},{"diffs":[[0," are not"],[-1,"\r"],[0,"\n    // "]],"start1":1281,"start2":1281,"length1":17,"length2":16},{"diffs":[[0,"hes (--)"],[-1,"\r"],[0,"\n    url"]],"start1":1322,"start2":1322,"length1":17,"length2":16},{"diffs":[[0,"function() {"],[-1,"\r"],[0,"\n"],[1," "],[0,"       var u"]],"start1":1340,"start2":1340,"length1":26,"length2":26},{"diffs":[[0,", arguments)"],[-1,"\r"],[0,"\n"],[1,"        console.log(url)\n "],[0,"       retur"]],"start1":1410,"start2":1410,"length1":26,"length2":51},{"diffs":[[0,"_rev\"));"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n    // "]],"start1":1506,"start2":1506,"length1":25,"length2":23},{"diffs":[[0,"me down the "],[-1,"\r"],[0,"\n    // wire"]],"start1":1583,"start2":1583,"length1":25,"length2":24},{"diffs":[[0,"llection"],[-1,"\r"],[0,"\n    // "]],"start1":1661,"start2":1661,"length1":17,"length2":16},{"diffs":[[0,"ckbone model"],[-1,"\r"],[0,"\n    parse: "]],"start1":1706,"start2":1706,"length1":25,"length2":24},{"diffs":[[0,"(resp) {"],[-1,"\r"],[0,"\n       "]],"start1":1738,"start2":1738,"length1":17,"length2":16},{"diffs":[[0,"ne(resp)"],[-1,"\r"],[0,"\n       "]],"start1":1771,"start2":1771,"length1":17,"length2":16},{"diffs":[[0,"key, list) {"],[-1,"\r"],[0,"\n           "]],"start1":1854,"start2":1854,"length1":25,"length2":24},{"diffs":[[0,"return {"],[-1,"\r"],[0,"\n       "]],"start1":1879,"start2":1879,"length1":17,"length2":16},{"diffs":[[0,"id: key,"],[-1,"\r"],[0,"\n       "]],"start1":1904,"start2":1904,"length1":17,"length2":16},{"diffs":[[0,"content_type"],[-1,"\r"],[0,"\n           "]],"start1":1953,"start2":1953,"length1":25,"length2":24},{"diffs":[[0,"pe\n            }"],[-1,"\r"],[0,"\n        }, this"]],"start1":1963,"start2":1963,"length1":33,"length2":32},{"diffs":[[0,"        }, this)"],[-1,"\r"],[0,"\n        this._a"]],"start1":1980,"start2":1980,"length1":33,"length2":32},{"diffs":[[0,"attachments)"],[-1,"\r"],[0,"\n        thi"]],"start1":2036,"start2":2036,"length1":25,"length2":24},{"diffs":[[0,"ts_order"],[-1,"\r"],[0,"\n       "]],"start1":2096,"start2":2096,"length1":17,"length2":16},{"diffs":[[0,"rn resp;"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n    // "]],"start1":2117,"start2":2117,"length1":25,"length2":23},{"diffs":[[0,"ir types"],[-1,"\r"],[0,"\n    add"]],"start1":2185,"start2":2185,"length1":17,"length2":16},{"diffs":[[0,"up: function() {"],[-1,"\r"],[0,"\n        if (thi"]],"start1":2214,"start2":2214,"length1":33,"length2":32},{"diffs":[[0,"=== 0) {"],[-1,"\r"],[0,"\n       "]],"start1":2268,"start2":2268,"length1":17,"length2":16},{"diffs":[[0,"w_id = 1"],[-1,"\r"],[0,"\n       "]],"start1":2295,"start2":2295,"length1":17,"length2":16},{"diffs":[[0,"id = 1\n        }"],[-1,"\r"],[0,"\n        else {\r"]],"start1":2297,"start2":2297,"length1":33,"length2":32},{"diffs":[[0,"  else {"],[-1,"\r"],[0,"\n       "]],"start1":2320,"start2":2320,"length1":17,"length2":16},{"diffs":[[0,"ttachment) {"],[-1,"\r"],[0,"\n           "]],"start1":2383,"start2":2383,"length1":25,"length2":24},{"diffs":[[0,"it(\"-\");"],[-1,"\r"],[0,"\n       "]],"start1":2441,"start2":2441,"length1":17,"length2":16},{"diffs":[[0,"rn split[1];"],[-1,"\r"],[0,"\n           "]],"start1":2470,"start2":2470,"length1":25,"length2":24},{"diffs":[[0,";\n            })"],[-1,"\r"],[0,"\n            var"]],"start1":2481,"start2":2481,"length1":33,"length2":32},{"diffs":[[0,"1]) + 1;"],[-1,"\r"],[0,"\n       "]],"start1":2550,"start2":2550,"length1":17,"length2":16},{"diffs":[[0,") + 1;\n        }"],[-1,"\r"],[0,"\n        this.at"]],"start1":2552,"start2":2552,"length1":33,"length2":32},{"diffs":[[0,"function(type) {"],[-1,"\r"],[0,"\n            thi"]],"start1":2607,"start2":2607,"length1":33,"length2":32},{"diffs":[[0,"ts.add({"],[-1,"\r"],[0,"\n       "]],"start1":2651,"start2":2651,"length1":17,"length2":16},{"diffs":[[0,"+ new_id"],[-1,"\r"],[0,"\n       "]],"start1":2691,"start2":2691,"length1":17,"length2":16},{"diffs":[[0,"d\n            })"],[-1,"\r"],[0,"\n        }, this"]],"start1":2698,"start2":2698,"length1":33,"length2":32},{"diffs":[[0,"        }, this)"],[-1,"\r"],[0,"\n        this.at"]],"start1":2715,"start2":2715,"length1":33,"length2":32},{"diffs":[[0,"push(new_id)"],[-1,"\r"],[0,"\n        thi"]],"start1":2763,"start2":2763,"length1":25,"length2":24},{"diffs":[[0,"_id)"],[-1,"\r"],[0,"\n    },"],[-1,"\r\n    sync: function() {\r\n        console.log(this.attachments_loading_counter)\r\n        var xhr, args = arguments;\r\n\r\n        // Because the FileReader API is asynchronous we have to use a callback\r\n        // style to call Backbone.sync when the files have been read\r\n        this.saveForCouchDB"],[1,"\n\n    // We override the toJSON function as this is what Backbone.sync uses to \n    // save our model to the server.\n    toJSON: function() {\n        var json = _.clone(this.attributes);\n        json._attachments = {};\n        json.attachments_order = this.attachments_order;\n        this._attachments.each"],[0,"(fun"]],"start1":2826,"start2":2826,"length1":313,"length2":321},{"diffs":[[0,"(att"],[-1,"rs"],[1,"achment"],[0,") {"],[-1,"\r"],[0,"\n   "]],"start1":3152,"start2":3152,"length1":14,"length2":18},{"diffs":[[0,"    "],[-1,"args[2].attrs = attrs; // args[2] is the options object from arguments\r\n            xhr = Backbone.sync.apply(this, args);\r"],[1,"if (attachment.get(\"base64\")) {\n                json._attachments[attachment.id] = {\n                    content_type: attachment.get(\"content_type\"),\n                    data: attachment.get(\"base64\")\n                }\n            }\n            else {\n                json._attachments[attachment.id] = {\n                    stub: true\n                }\n            }"],[0,"\n   "]],"start1":3175,"start2":3175,"length1":131,"length2":376},{"diffs":[[0,"    }\n        })"],[-1,"\r"],[0,"\n        return "]],"start1":3542,"start2":3542,"length1":33,"length2":32},{"diffs":[[0,"urn "],[-1,"xhr;\r"],[1,"json;"],[0,"\n    },"],[-1,"\r"],[0,"\n    "],[-1,"// We override the toJSON function as this is what Backbone.sync uses to \r\n    // save our model to the server.\r"],[1,"sync: function() {\n        if (this.attachments_loading_counter > 0) {\n            this.waitingForSave = arguments;\n        }\n        else {\n            this.waitingForSave = null;\n            var xhr = Backbone.sync.apply(this, arguments);\n        }\n        return xhr;"],[0,"\n   "],[-1,"\r"],[1," },"],[0,"\n   "]],"start1":3570,"start2":3570,"length1":143,"length2":302},{"diffs":[[0,"_id\""],[-1,"\r"],[0,"\n});"],[-1,"\r\n\r"],[1,"\n"],[0,"\n///"]],"start1":3887,"start2":3887,"length1":16,"length2":13},{"diffs":[[0,"////////"],[-1,"\r"],[0,"\n// VIEW"]],"start1":3970,"start2":3970,"length1":17,"length2":16},{"diffs":[[0,"// VIEWS"],[-1,"\r"],[0,"\n///////"]],"start1":3979,"start2":3979,"length1":17,"length2":16},{"diffs":[[0,"////////"],[-1,"\r\n\r"],[1,"\n"],[0,"\nBackbon"]],"start1":4061,"start2":4061,"length1":19,"length2":17},{"diffs":[[0,"iew.extend({"],[-1,"\r"],[0,"\n    constru"]],"start1":4108,"start2":4108,"length1":25,"length2":24},{"diffs":[[0,"or: function() {"],[-1,"\r"],[0,"\n        var tha"]],"start1":4134,"start2":4134,"length1":33,"length2":32},{"diffs":[[0,"var that = this;"],[-1,"\r"],[0,"\n        Backbon"]],"start1":4159,"start2":4159,"length1":33,"length2":32},{"diffs":[[0,"guments)"],[-1,"\r"],[0,"\n       "]],"start1":4212,"start2":4212,"length1":17,"length2":16},{"diffs":[[0,"', function(e) {"],[-1,"\r"],[0,"\n            e.p"]],"start1":4263,"start2":4263,"length1":33,"length2":32},{"diffs":[[0,"reventDefault();"],[-1,"\r"],[0,"\n        }      "]],"start1":4295,"start2":4295,"length1":33,"length2":32},{"diffs":[[0,"       }"],[1,");\n"],[0,"        "]],"start1":4313,"start2":4313,"length1":16,"length2":19},{"diffs":[[0,"le, set the "],[-1,"\r"],[0,"\n        // "]],"start1":4401,"start2":4401,"length1":25,"length2":24},{"diffs":[[0,"odel to "],[-1,"\r"],[0,"\n       "]],"start1":4491,"start2":4491,"length1":17,"length2":16},{"diffs":[[0,"essfully"],[-1,"\r"],[0,"\n       "]],"start1":4556,"start2":4556,"length1":17,"length2":16},{"diffs":[[0,"unction(e) {"],[-1,"\r"],[0,"\n           "]],"start1":4607,"start2":4607,"length1":25,"length2":24},{"diffs":[[0,"fault();"],[-1,"\r"],[0,"\n       "]],"start1":4643,"start2":4643,"length1":17,"length2":16},{"diffs":[[0,"iles[0];"],[-1,"\r\n\r"],[1,"\n"],[0,"\n       "]],"start1":4691,"start2":4691,"length1":19,"length2":17},{"diffs":[[0,"eader();"],[-1,"\r"],[0,"\n       "]],"start1":4736,"start2":4736,"length1":17,"length2":16},{"diffs":[[0,"event) {"],[-1,"\r"],[0,"\n       "]],"start1":4783,"start2":4783,"length1":17,"length2":16},{"diffs":[[0,"\",\")[1];"],[-1,"\r"],[0,"\n       "]],"start1":4845,"start2":4845,"length1":17,"length2":16},{"diffs":[[0,"el.set({"],[-1,"\r"],[0,"\n       "]],"start1":4878,"start2":4878,"length1":17,"length2":16},{"diffs":[[0,"4: data,"],[-1,"\r"],[0,"\n       "]],"start1":4912,"start2":4912,"length1":17,"length2":16},{"diffs":[[0,".result,"],[-1,"\r"],[0,"\n       "]],"start1":4962,"start2":4962,"length1":17,"length2":16},{"diffs":[[0,"ile.type"],[-1,"\r"],[0,"\n       "]],"start1":5006,"start2":5006,"length1":17,"length2":16},{"diffs":[[0,"             });"],[-1,"\r"],[0,"\n               "]],"start1":5018,"start2":5018,"length1":33,"length2":32},{"diffs":[[0,"-saved\")"],[-1,"\r"],[0,"\n       "]],"start1":5093,"start2":5093,"length1":17,"length2":16},{"diffs":[[0,"\")\n            }"],[-1,"\r"],[0,"\n            tha"]],"start1":5099,"start2":5099,"length1":33,"length2":32},{"diffs":[[0,"unter++;"],[-1,"\r"],[0,"\n       "]],"start1":5179,"start2":5179,"length1":17,"length2":16},{"diffs":[[0,"RL(file)"],[-1,"\r"],[0,"\n       "]],"start1":5219,"start2":5219,"length1":17,"length2":16},{"diffs":[[0,"     });"],[-1,"\r"],[0,"\n    }"],[-1,"\r"],[0,"\n})"],[-1,"\r\n\r"],[1,"\n"],[0,"\nBackbon"]],"start1":5231,"start2":5231,"length1":30,"length2":26},{"diffs":[[0,"iew.extend({"],[-1,"\r"],[0,"\n    initial"]],"start1":5288,"start2":5288,"length1":25,"length2":24},{"diffs":[[0,"ze: function() {"],[-1,"\r"],[0,"\n        this.mo"]],"start1":5313,"start2":5313,"length1":33,"length2":32},{"diffs":[[0,"ender, this)"],[-1,"\r"],[0,"\n        thi"]],"start1":5366,"start2":5366,"length1":25,"length2":24},{"diffs":[[0,"p, this)"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n    // "]],"start1":5449,"start2":5449,"length1":25,"length2":23},{"diffs":[[0,"chment model"],[-1,"\r"],[0,"\n    // when"]],"start1":5528,"start2":5528,"length1":25,"length2":24},{"diffs":[[0,"called. "],[-1,"\r"],[0,"\n    add"]],"start1":5614,"start2":5614,"length1":17,"length2":16},{"diffs":[[0,": function(id) {"],[-1,"\r"],[0,"\n        this.$e"]],"start1":5645,"start2":5645,"length1":33,"length2":32},{"diffs":[[0,"oup(id))"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n    ren"]],"start1":5700,"start2":5700,"length1":25,"length2":23},{"diffs":[[0,"er: function() {"],[-1,"\r"],[0,"\n        var tha"]],"start1":5724,"start2":5724,"length1":33,"length2":32},{"diffs":[[0,"that = this;"],[-1,"\r"],[0,"\n        thi"]],"start1":5753,"start2":5753,"length1":25,"length2":24},{"diffs":[[0,"empty();"],[-1,"\r"],[0,"\n       "]],"start1":5783,"start2":5783,"length1":17,"length2":16},{"diffs":[[0,"n(key) {"],[-1,"\r"],[0,"\n       "]],"start1":5844,"start2":5844,"length1":17,"length2":16},{"diffs":[[0,"p(key));"],[-1,"\r"],[0,"\n       "]],"start1":5897,"start2":5897,"length1":17,"length2":16},{"diffs":[[0,"        }, this)"],[-1,"\r"],[0,"\n        this.$e"]],"start1":5906,"start2":5906,"length1":33,"length2":32},{"diffs":[[0,"rtable({"],[-1,"\r"],[0,"\n       "]],"start1":5942,"start2":5942,"length1":17,"length2":16},{"diffs":[[0,"t, ui) {"],[-1,"\r"],[0,"\n       "]],"start1":5984,"start2":5984,"length1":17,"length2":16},{"diffs":[[0,"Array\");"],[-1,"\r"],[0,"\n       "]],"start1":6060,"start2":6060,"length1":17,"length2":16},{"diffs":[[0,"       }"],[-1,"\r"],[0,"\n       "]],"start1":6074,"start2":6074,"length1":17,"length2":16},{"diffs":[[0,"      })"],[-1,"\r"],[0,"\n       "]],"start1":6085,"start2":6085,"length1":17,"length2":16},{"diffs":[[0,"rn this;"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n    _re"]],"start1":6106,"start2":6106,"length1":25,"length2":23},{"diffs":[[0,"on(id) {"],[-1,"\r"],[0,"\n       "]],"start1":6146,"start2":6146,"length1":17,"length2":16},{"diffs":[[0," = $('<'"],[-1,"+"],[1," + "],[0,"this.opt"]],"start1":6187,"start2":6187,"length1":17,"length2":19},{"diffs":[[0," + '></'"],[-1,"+"],[1," + "],[0,"this.opt"]],"start1":6218,"start2":6218,"length1":17,"length2":19},{"diffs":[[0,"El +"],[1," "],[0,"'>', {"],[-1,"\r"],[0,"\n   "]],"start1":6247,"start2":6247,"length1":15,"length2":15},{"diffs":[[0,"  id: id"],[-1,"\r"],[0,"\n       "]],"start1":6269,"start2":6269,"length1":17,"length2":16},{"diffs":[[0,"     });"],[-1,"\r"],[0,"\n       "]],"start1":6281,"start2":6281,"length1":17,"length2":16},{"diffs":[[0,"(type) {"],[-1,"\r"],[0,"\n       "]],"start1":6342,"start2":6342,"length1":17,"length2":16},{"diffs":[[0,"-\" + id;"],[-1,"\r"],[0,"\n       "]],"start1":6391,"start2":6391,"length1":17,"length2":16},{"diffs":[[0,"ent_id);"],[-1,"\r\n\r"],[1,"\n"],[0,"\n       "]],"start1":6464,"start2":6464,"length1":19,"length2":17},{"diffs":[[0,"s.view({"],[-1,"\r"],[0,"\n       "]],"start1":6515,"start2":6515,"length1":17,"length2":16},{"diffs":[[0,"butes: {"],[-1,"\r"],[0,"\n       "]],"start1":6545,"start2":6545,"length1":17,"length2":16},{"diffs":[[0,"hment_id"],[-1,"\r"],[0,"\n       "]],"start1":6583,"start2":6583,"length1":17,"length2":16},{"diffs":[[0,"          },"],[-1,"\r"],[0,"\n           "]],"start1":6598,"start2":6598,"length1":25,"length2":24},{"diffs":[[0,": attachment"],[-1,"\r"],[0,"\n           "]],"start1":6632,"start2":6632,"length1":25,"length2":24},{"diffs":[[0,"render()"],[-1,"\r"],[0,"\n       "]],"start1":6660,"start2":6660,"length1":17,"length2":16},{"diffs":[[0,"iew.el);"],[-1,"\r"],[0,"\n       "]],"start1":6713,"start2":6713,"length1":17,"length2":16},{"diffs":[[0,"}, this)"],[-1,"\r"],[0,"\n       "]],"start1":6730,"start2":6730,"length1":17,"length2":16},{"diffs":[[0,"s_el"],[-1,"\r"],[0,"\n    }"],[-1,"\r"],[0,"\n})"],[-1,"\r\n\r"],[1,"\n"],[0,"\nBac"]],"start1":6770,"start2":6770,"length1":22,"length2":18},{"diffs":[[0,"extend({"],[-1,"\r"],[0,"\n    add"]],"start1":6823,"start2":6823,"length1":17,"length2":16},{"diffs":[[0,"tion() {"],[-1,"\r"],[0,"\n       "]],"start1":6855,"start2":6855,"length1":17,"length2":16},{"diffs":[[0,"p();"],[-1,"\r"],[0,"\n    },"],[-1,"\r"],[0,"\n   "]],"start1":6900,"start2":6900,"length1":17,"length2":15},{"diffs":[[0,"is view "],[1,"in your application "],[0,"and then"]],"start1":6928,"start2":6928,"length1":16,"length2":36},{"diffs":[[0,"s(view) "],[1,"\n    // "],[0,"from wit"]],"start1":6985,"start2":6985,"length1":16,"length2":24},{"diffs":[[0,"hin the "],[-1,"\r\n    // "],[0,"extended"]],"start1":7009,"start2":7009,"length1":25,"length2":16},{"diffs":[[0,"ng it an"],[1," Backbone view\n    //"],[0," extende"]],"start1":7055,"start2":7055,"length1":16,"length2":37},{"diffs":[[0,"ded "],[1,"from "],[0,"Backbone"],[-1," view\r\n    //"],[1,".View.Attachment"],[0," to "]],"start1":7090,"start2":7090,"length1":29,"length2":37},{"diffs":[[0,"ment"],[-1,". \r"],[0,"\n   "]],"start1":7156,"start2":7156,"length1":11,"length2":8},{"diffs":[[0,"tions) {"],[-1,"\r"],[0,"\n       "]],"start1":7194,"start2":7194,"length1":17,"length2":16},{"diffs":[[0,"ns || {}"],[-1,"\r"],[0,"\n       "]],"start1":7226,"start2":7226,"length1":17,"length2":16},{"diffs":[[0,"is.model"],[-1,"\r"],[0,"\n       "]],"start1":7261,"start2":7261,"length1":17,"length2":16},{"diffs":[[0,"mentView"],[-1,"\r"],[0,"\n       "]],"start1":7312,"start2":7312,"length1":17,"length2":16},{"diffs":[[0,"options)"],[-1,"\r"],[0,"\n       "]],"start1":7393,"start2":7393,"length1":17,"length2":16},{"diffs":[[0,"der().el"],[-1,"\r"],[0,"\n       "]],"start1":7472,"start2":7472,"length1":17,"length2":16},{"diffs":[[0,"ment"],[-1,"\r"],[0,"\n    }"],[-1,"\r"],[0,"\n})"],[-1,"\r"],[0,"\n"]],"start1":7516,"start2":7516,"length1":17,"length2":14}]],"length":7530,"saved":false}
{"ts":1362486188021,"patch":[[{"diffs":[[0,".log(url"],[1," + this.get(\"_rev\")"],[0,")\n      "]],"start1":1438,"start2":1438,"length1":16,"length2":35}]],"length":7549,"saved":false}
{"ts":1362486200138,"patch":[[{"diffs":[[0,"ts)\n"],[-1,"        console.log(url + this.get(\"_rev\"))\n"],[0,"    "]],"start1":1419,"start2":1419,"length1":52,"length2":8}]],"length":7505,"saved":false}
{"ts":1362486384083,"patch":[[{"diffs":[[0,"     return "],[1,"("],[0,"this.isNew ?"]],"start1":1426,"start2":1426,"length1":24,"length2":25},{"diffs":[[0,"\"_rev\"))"],[1,")"],[0,";\n    },"]],"start1":1481,"start2":1481,"length1":16,"length2":17}]],"length":7507,"saved":false}
{"ts":1362486440927,"patch":[[{"diffs":[[0,"        "],[-1,"return "],[1,"if"],[0,"(this.is"]],"start1":1423,"start2":1423,"length1":23,"length2":18},{"diffs":[[0,"sNew"],[-1," ? url : ("],[1,") {\n            console.log(\"Is new\")\n            return url;\n        }\n        else {\n        return "],[0,"url "]],"start1":1440,"start2":1440,"length1":18,"length2":110},{"diffs":[[0,"(\"_rev\")"],[-1,"))"],[1,"\n        }"],[0,";\n    },"]],"start1":1567,"start2":1567,"length1":18,"length2":26}]],"length":7602,"saved":false}
{"ts":1362486471786,"patch":[[{"diffs":[[0,"is.isNew) {\n"],[1,"            console.log(this.id)\n"],[0,"            "]],"start1":1436,"start2":1436,"length1":24,"length2":57}]],"length":7635,"saved":false}
{"ts":1362486487911,"patch":[[{"diffs":[[0,"is.isNew"],[1,"()"],[0,") {\n    "]],"start1":1436,"start2":1436,"length1":16,"length2":18}]],"length":7637,"saved":false}
{"ts":1362486514166,"patch":[[{"diffs":[[0,"ts)\n"],[1,"\n"],[0,"        "],[-1,"if("],[1,"return "],[0,"this"]],"start1":1419,"start2":1419,"length1":19,"length2":24},{"diffs":[[0,"ew()"],[-1,") {\n            console.log(this.id)\n            console.log(\"Is new\")\n            return url;\n        }\n        else {\n        return "],[1," ? url : ("],[0,"url "]],"start1":1447,"start2":1447,"length1":143,"length2":18},{"diffs":[[0,"(\"_rev\")"],[-1,"\n        }"],[1,")"],[0,";\n    },"]],"start1":1482,"start2":1482,"length1":26,"length2":17}]],"length":7508,"saved":false}
{"ts":1362486516900,"patch":[[{"diffs":[[0,"uments)\n"],[-1,"\n"],[0,"        "]],"start1":1415,"start2":1415,"length1":17,"length2":16}]],"length":7507,"saved":false}
